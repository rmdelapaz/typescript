<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Master React's useState Hook - Learn how to add state to functional components, update state correctly, work with objects and arrays, and type state with TypeScript.">
    <meta name="author" content="PracticalAce">
    <title>useState Hook - React TypeScript Course</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="icon" type="image/png" href="/favicon.png">
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#f0f0f0',
                primaryTextColor: '#333',
                primaryBorderColor: '#667eea'
            }
        });
    </script>
</head>
<body>
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="skip-to-main">Skip to main content</a>
    
    <!-- Progress indicator -->
    <div class="progress-indicator" role="progressbar" aria-label="Page scroll progress">
        <div class="progress-bar"></div>
    </div>

    <!-- Navigation -->
    <nav>
        <div class="nav-container">
            <a href="index.html" class="nav-logo">React TypeScript Course</a>
            <button id="mobile-menu-toggle" class="mobile-menu-toggle" aria-expanded="false" aria-controls="nav-links">
                ‚ò∞
            </button>
            <div class="nav-links" id="nav-links" aria-hidden="false">
                <a href="index.html">Home</a>
                <a href="index.html#modules">All Modules</a>
                <button id="theme-toggle" aria-label="Toggle theme">üåô</button>
            </div>
        </div>
    </nav>

    <!-- Breadcrumb -->
    <nav class="breadcrumb" aria-label="Breadcrumb">
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="index.html#module3">Module 3: State and Interactivity</a></li>
            <li aria-current="page">Lesson 3.1: useState Hook</li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main id="main-content">
        <div class="container">
            <!-- Lesson Header -->
            <header>
                <h1>üé£ useState Hook</h1>
                <p class="lead">Welcome to the world of React Hooks! Up until now, your components have been pretty static - displaying information but not really changing. But real applications need to remember things, respond to users, and update dynamically. That's where state comes in! The useState Hook is your gateway to making components truly interactive and alive. Think of it as giving your components a memory - they can remember values, change them over time, and trigger re-renders when things change. Let's unlock this superpower! üöÄ</p>
                
                <!-- Learning objectives -->
                <div class="card">
                    <h2>üéØ Learning Objectives</h2>
                    <p>By the end of this lesson, you will be able to:</p>
                    <ul>
                        <li>Understand what React Hooks are and why they exist</li>
                        <li>Use the useState Hook to add state to functional components</li>
                        <li>Properly type state variables with TypeScript</li>
                        <li>Update state correctly and understand why it's important</li>
                        <li>Work with different state types: primitives, objects, and arrays</li>
                        <li>Use functional updates for state that depends on previous values</li>
                        <li>Build interactive components that respond to user actions</li>
                        <li>Debug common useState mistakes</li>
                    </ul>
                    <p><strong>Estimated Time:</strong> 70-85 minutes</p>
                    <p><strong>Project:</strong> Build a counter, a toggle button, and a form with controlled inputs</p>
                </div>
            </header>

            <!-- Sticky Table of Contents -->
            <details class="card" open style="position: sticky; top: 80px; z-index: 100; background: var(--card-bg, white); box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem;">
                <summary style="cursor: pointer; font-weight: bold; padding: 0.5rem 1rem; user-select: none;">
                    <h2 style="display: inline; margin: 0;">üìë In This Lesson</h2>
                </summary>
                <nav aria-label="Table of Contents" style="padding: 0 1rem 1rem 1rem;">
                    <ol>
                        <li><a href="#section1" class="toc-link">Introduction to React Hooks</a></li>
                        <li><a href="#section2" class="toc-link">What is State?</a></li>
                        <li><a href="#section3" class="toc-link">useState Basics</a></li>
                        <li><a href="#section4" class="toc-link">Typing State with TypeScript</a></li>
                        <li><a href="#section5" class="toc-link">Updating State Correctly</a></li>
                        <li><a href="#section6" class="toc-link">State with Objects</a></li>
                        <li><a href="#section7" class="toc-link">State with Arrays</a></li>
                        <li><a href="#section8" class="toc-link">Functional Updates</a></li>
                        <li><a href="#section9" class="toc-link">Hands-on Practice</a></li>
                        <li><a href="#section10" class="toc-link">Common Mistakes</a></li>
                        <li><a href="#section11" class="toc-link">Best Practices</a></li>
                        <li><a href="#section12" class="toc-link">Summary</a></li>
                    </ol>
                </nav>
            </details>

            <!-- Section 1: Introduction to React Hooks -->
            <section id="section1" class="lesson-section">
                <h2>üé£ Introduction to React Hooks</h2>
                <p>Before we dive into useState specifically, let's understand what Hooks are and why React introduced them.</p>

                <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                    <h4 style="color: white;">üìñ Definition</h4>
                    <p style="color: white;"><strong>React Hooks:</strong> Functions that let you "hook into" React features from functional components. They let you use state and other React features without writing a class component.</p>
                </div>

                <h3>Why Hooks?</h3>
                <p>React Hooks were introduced in React 16.8 (February 2019) to solve several problems:</p>

                <table>
                    <thead>
                        <tr>
                            <th>Problem</th>
                            <th>How Hooks Help</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Class components were complex</td>
                            <td>Functional components with Hooks are simpler</td>
                        </tr>
                        <tr>
                            <td>Difficult to reuse stateful logic</td>
                            <td>Custom Hooks make logic reusable</td>
                        </tr>
                        <tr>
                            <td>Related code was scattered</td>
                            <td>Hooks group related logic together</td>
                        </tr>
                        <tr>
                            <td>"this" keyword confusion</td>
                            <td>No classes = no "this" to worry about</td>
                        </tr>
                    </tbody>
                </table>

                <h3>The Hook Rules</h3>
                <div class="card" style="background-color: #fff3cd; border-left: 4px solid #ffc107;">
                    <h4>‚ö†Ô∏è Important: Rules of Hooks</h4>
                    <p>Hooks have two critical rules that you must follow:</p>
                    <ol>
                        <li><strong>Only call Hooks at the top level</strong> - Don't call Hooks inside loops, conditions, or nested functions</li>
                        <li><strong>Only call Hooks from React functions</strong> - Call them from functional components or custom Hooks</li>
                    </ol>
                    <p>Why? React relies on the order Hooks are called to keep track of state. Changing the order breaks everything!</p>
                </div>

                <h3>Common React Hooks</h3>
                <p>React provides several built-in Hooks. Here are the most important ones:</p>

                <pre class="mermaid">
graph TD
    A[React Hooks] --> B[useState]
    A --> C[useEffect]
    A --> D[useContext]
    A --> E[useReducer]
    A --> F[useRef]
    A --> G[useMemo]
    A --> H[useCallback]
    
    B --> B1[Manage state]
    C --> C1[Side effects]
    D --> D1[Context values]
    E --> E1[Complex state logic]
    
    style B fill:#667eea,color:#fff
    style C fill:#764ba2,color:#fff
    style D fill:#f093fb,color:#fff
    style E fill:#2196F3,color:#fff
</pre>

                <p>Today we're focusing on <code>useState</code> - the most fundamental and commonly used Hook!</p>

                <div class="card" style="background: #e3f2fd; border-left: 4px solid #2196F3;">
                    <h4>üí° Good to Know</h4>
                    <p>All React Hooks start with the word "use". This is a convention that helps you instantly recognize them. You can also create your own custom Hooks - and they should also start with "use"!</p>
                </div>
            </section>

            <!-- Section 2: What is State? -->
            <section id="section2" class="lesson-section">
                <h2>üß† What is State?</h2>
                <p>Before we learn how to use useState, let's make sure we understand what "state" actually means in React.</p>

                <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                    <h4 style="color: white;">üìñ Definition</h4>
                    <p style="color: white;"><strong>State:</strong> Data that changes over time in your component. It's information that the component needs to remember between renders. When state changes, the component re-renders to reflect the new state.</p>
                </div>

                <h3>State vs Props vs Variables</h3>
                <p>It's crucial to understand how state differs from other types of data in React:</p>

                <table>
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th>Purpose</th>
                            <th>Changes?</th>
                            <th>Triggers Re-render?</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>State</strong></td>
                            <td>Data owned by the component</td>
                            <td>‚úÖ Yes, using setState</td>
                            <td>‚úÖ Yes</td>
                        </tr>
                        <tr>
                            <td><strong>Props</strong></td>
                            <td>Data passed from parent</td>
                            <td>‚ùå Read-only in component</td>
                            <td>‚úÖ Yes (when parent changes them)</td>
                        </tr>
                        <tr>
                            <td><strong>Regular Variables</strong></td>
                            <td>Temporary calculations</td>
                            <td>‚úÖ Yes, but resets on re-render</td>
                            <td>‚ùå No</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Analogy: State is Like Memory</h3>
                <div class="card">
                    <h4>üß† Think of it this way:</h4>
                    <p>Imagine you're taking notes during a lecture:</p>
                    <ul>
                        <li><strong>Props</strong> are like the lecture slides the professor shows you - you can read them but can't change them</li>
                        <li><strong>State</strong> is like your notebook - you write things down, update them, and refer back to them later</li>
                        <li><strong>Regular variables</strong> are like mental math you do in your head - they're gone once you move to the next problem</li>
                    </ul>
                    <p>Your notebook (state) persists throughout the lecture, even as new slides (props) are shown!</p>
                </div>

                <h3>When Do You Need State?</h3>
                <p>Use state when your component needs to remember information that:</p>
                <ul>
                    <li>Changes based on user interactions (clicks, input, etc.)</li>
                    <li>Changes over time (counters, timers)</li>
                    <li>Affects what the component displays</li>
                    <li>Needs to persist across re-renders</li>
                </ul>

                <h3>Examples of State in the Wild</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Component</th>
                            <th>State It Might Have</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Counter</td>
                            <td>Current count number</td>
                        </tr>
                        <tr>
                            <td>Form Input</td>
                            <td>Current text value</td>
                        </tr>
                        <tr>
                            <td>Modal Dialog</td>
                            <td>Whether it's open or closed</td>
                        </tr>
                        <tr>
                            <td>Todo List</td>
                            <td>Array of todo items</td>
                        </tr>
                        <tr>
                            <td>Toggle Switch</td>
                            <td>Whether it's on or off</td>
                        </tr>
                        <tr>
                            <td>Shopping Cart</td>
                            <td>Items in cart, total price</td>
                        </tr>
                    </tbody>
                </table>

                <!-- SVG: State vs Props vs Variables Visual Comparison -->
                <h3>üéØ Visual Comparison</h3>
                <svg viewBox="0 0 850 420" style="width: 100%; max-width: 850px; height: auto; margin: 2rem auto; display: block; font-family: system-ui, sans-serif;">
                    <defs>
                        <linearGradient id="stateGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#667eea"/>
                            <stop offset="100%" style="stop-color:#764ba2"/>
                        </linearGradient>
                        <linearGradient id="propsGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#4CAF50"/>
                            <stop offset="100%" style="stop-color:#388E3C"/>
                        </linearGradient>
                        <linearGradient id="varsGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#FF9800"/>
                            <stop offset="100%" style="stop-color:#F57C00"/>
                        </linearGradient>
                        <filter id="dropShadow" x="-20%" y="-20%" width="140%" height="140%">
                            <feDropShadow dx="2" dy="3" stdDeviation="3" flood-opacity="0.2"/>
                        </filter>
                    </defs>
                    
                    <!-- Title -->
                    <text x="425" y="30" text-anchor="middle" fill="#333" font-weight="bold" font-size="18">State vs Props vs Variables</text>
                    
                    <!-- STATE Column -->
                    <g transform="translate(50, 60)">
                        <rect x="0" y="0" width="220" height="340" rx="12" fill="#f8f4ff" stroke="#667eea" stroke-width="2" filter="url(#dropShadow)"/>
                        <rect x="0" y="0" width="220" height="50" rx="12" fill="url(#stateGrad)"/>
                        <text x="110" y="32" text-anchor="middle" fill="white" font-weight="bold" font-size="16">üé£ STATE</text>
                        
                        <rect x="70" y="70" width="80" height="60" rx="8" fill="white" stroke="#667eea" stroke-width="2"/>
                        <text x="110" y="95" text-anchor="middle" fill="#667eea" font-size="11" font-weight="bold">useState()</text>
                        <text x="110" y="115" text-anchor="middle" fill="#666" font-size="10">Memory</text>
                        
                        <text x="15" y="160" fill="#333" font-size="11" font-weight="bold">‚úì Component owns it</text>
                        <text x="15" y="185" fill="#333" font-size="11" font-weight="bold">‚úì Can be changed</text>
                        <text x="15" y="210" fill="#333" font-size="11" font-weight="bold">‚úì Triggers re-render</text>
                        <text x="15" y="235" fill="#333" font-size="11" font-weight="bold">‚úì Persists between renders</text>
                        
                        <rect x="10" y="260" width="200" height="65" rx="6" fill="#E8F5E9" stroke="#4CAF50" stroke-width="1"/>
                        <text x="20" y="280" fill="#333" font-size="10" font-family="monospace">const [count, setCount]</text>
                        <text x="20" y="295" fill="#333" font-size="10" font-family="monospace">  = useState(0);</text>
                        <text x="20" y="315" fill="#4CAF50" font-size="10" font-weight="bold">// Changes? Re-render!</text>
                    </g>
                    
                    <!-- PROPS Column -->
                    <g transform="translate(315, 60)">
                        <rect x="0" y="0" width="220" height="340" rx="12" fill="#f4fff4" stroke="#4CAF50" stroke-width="2" filter="url(#dropShadow)"/>
                        <rect x="0" y="0" width="220" height="50" rx="12" fill="url(#propsGrad)"/>
                        <text x="110" y="32" text-anchor="middle" fill="white" font-weight="bold" font-size="16">üì¶ PROPS</text>
                        
                        <rect x="70" y="70" width="80" height="60" rx="8" fill="white" stroke="#4CAF50" stroke-width="2"/>
                        <text x="110" y="95" text-anchor="middle" fill="#4CAF50" font-size="11" font-weight="bold">From Parent</text>
                        <text x="110" y="115" text-anchor="middle" fill="#666" font-size="10">Read-only</text>
                        
                        <text x="15" y="160" fill="#333" font-size="11" font-weight="bold">‚úì Passed from parent</text>
                        <text x="15" y="185" fill="#333" font-size="11" font-weight="bold">‚úó Cannot modify</text>
                        <text x="15" y="210" fill="#333" font-size="11" font-weight="bold">‚úì Changes cause re-render</text>
                        <text x="15" y="235" fill="#333" font-size="11" font-weight="bold">‚úì Flows down the tree</text>
                        
                        <rect x="10" y="260" width="200" height="65" rx="6" fill="#E3F2FD" stroke="#2196F3" stroke-width="1"/>
                        <text x="20" y="280" fill="#333" font-size="10" font-family="monospace">function Card({ title })</text>
                        <text x="20" y="295" fill="#333" font-size="10" font-family="monospace">// title is read-only</text>
                        <text x="20" y="315" fill="#2196F3" font-size="10" font-weight="bold">// Can't: title = "new"</text>
                    </g>
                    
                    <!-- VARIABLES Column -->
                    <g transform="translate(580, 60)">
                        <rect x="0" y="0" width="220" height="340" rx="12" fill="#fff8f0" stroke="#FF9800" stroke-width="2" filter="url(#dropShadow)"/>
                        <rect x="0" y="0" width="220" height="50" rx="12" fill="url(#varsGrad)"/>
                        <text x="110" y="32" text-anchor="middle" fill="white" font-weight="bold" font-size="16">üìù VARIABLES</text>
                        
                        <rect x="70" y="70" width="80" height="60" rx="8" fill="white" stroke="#FF9800" stroke-width="2"/>
                        <text x="110" y="95" text-anchor="middle" fill="#FF9800" font-size="11" font-weight="bold">const/let</text>
                        <text x="110" y="115" text-anchor="middle" fill="#666" font-size="10">Temporary</text>
                        
                        <text x="15" y="160" fill="#333" font-size="11" font-weight="bold">‚úì Local to render</text>
                        <text x="15" y="185" fill="#333" font-size="11" font-weight="bold">‚úì Can be changed</text>
                        <text x="15" y="210" fill="#E65100" font-size="11" font-weight="bold">‚úó No re-render</text>
                        <text x="15" y="235" fill="#E65100" font-size="11" font-weight="bold">‚úó Lost on re-render</text>
                        
                        <rect x="10" y="260" width="200" height="65" rx="6" fill="#FFF3E0" stroke="#FF9800" stroke-width="1"/>
                        <text x="20" y="280" fill="#333" font-size="10" font-family="monospace">const doubled = count * 2;</text>
                        <text x="20" y="295" fill="#333" font-size="10" font-family="monospace">// Recalculated each</text>
                        <text x="20" y="315" fill="#E65100" font-size="10" font-weight="bold">// render from scratch</text>
                    </g>
                </svg>
            </section>

            <!-- Section 3: useState Basics -->
            <section id="section3" class="lesson-section">
                <h2>üéØ useState Basics</h2>
                <p>Let's start using useState! We'll begin with the simplest possible example and build from there.</p>

                <h3>Basic Syntax</h3>
                <div class="card">
                    <h4>The useState Pattern</h4>
                    <pre><code class="language-typescript">import { useState } from 'react';

const [stateVariable, setStateVariable] = useState(initialValue);</code></pre>
                    <p>Let's break this down:</p>
                    <ul>
                        <li><code>useState</code> - The Hook function we're calling</li>
                        <li><code>initialValue</code> - The starting value of our state</li>
                        <li><code>stateVariable</code> - The current state value (read-only)</li>
                        <li><code>setStateVariable</code> - Function to update the state</li>
                        <li><code>[...]</code> - Array destructuring to get both values</li>
                    </ul>
                </div>

                <h3>Your First useState Example: A Counter</h3>
                <div class="card">
                    <h4>Simple Counter Component</h4>
                    <pre><code class="language-typescript">import React, { useState } from 'react';

const Counter: React.FC = () => {
    // Declare a state variable called 'count' with initial value 0
    const [count, setCount] = useState(0);

    return (
        &lt;div&gt;
            &lt;h2&gt;Counter: {count}&lt;/h2&gt;
            &lt;button onClick={() => setCount(count + 1)}&gt;
                Increment
            &lt;/button&gt;
        &lt;/div&gt;
    );
};

export default Counter;</code></pre>
                </div>

                <div class="card" style="background: #e3f2fd; border-left: 4px solid #2196F3;">
                    <h4>üí° What's Happening Here?</h4>
                    <ol>
                        <li><code>useState(0)</code> creates a state variable with initial value 0</li>
                        <li>We get back two things: the current value (<code>count</code>) and a function to update it (<code>setCount</code>)</li>
                        <li>We display the current count in the JSX</li>
                        <li>When the button is clicked, we call <code>setCount(count + 1)</code></li>
                        <li>React re-renders the component with the new count value</li>
                        <li>The display updates automatically!</li>
                    </ol>
                </div>

                <h3>How Re-rendering Works</h3>
                <pre class="mermaid">
sequenceDiagram
    participant User
    participant React
    participant Component
    
    User->>Component: Click button
    Component->>React: Call setCount(count + 1)
    React->>React: Update state
    React->>Component: Re-render with new state
    Component->>User: Display new count
    
    Note over React,Component: Component function runs again<br/>with new state value
</pre>

                <div class="card" style="background: #e8f5e9; border-left: 4px solid #4CAF50;">
                    <h4>‚úÖ Key Insight</h4>
                    <p><strong>State updates trigger re-renders.</strong> When you call the setter function (like <code>setCount</code>), React schedules a re-render of your component. On the next render, <code>useState</code> returns the updated value.</p>
                </div>

                <h3>Naming Conventions</h3>
                <p>By convention, we name the state variable and its setter following this pattern:</p>

                <pre><code class="language-typescript">const [thing, setThing] = useState(initialValue);

// Examples:
const [count, setCount] = useState(0);
const [name, setName] = useState('');
const [isOpen, setIsOpen] = useState(false);
const [items, setItems] = useState([]);
const [user, setUser] = useState(null);</code></pre>

                <p>The setter always starts with "set" followed by the capitalized state variable name. This makes it immediately clear what it does!</p>
            </section>

                <h3>üéÆ Interactive Demo: Watch the Re-render Cycle</h3>
                <p>Click the buttons and watch how React updates the component:</p>
                
                <div style="background: #f8f9fa; border-radius: 12px; padding: 1.5rem; margin: 1.5rem 0;">
                    <canvas id="useStateCanvas" width="750" height="350" style="width: 100%; max-width: 750px; display: block; margin: 0 auto; border: 1px solid #ddd; border-radius: 8px; background: white;"></canvas>
                    <div style="display: flex; justify-content: center; gap: 1rem; margin-top: 1rem;">
                        <button id="decrementBtn" style="padding: 0.5rem 1.5rem; font-size: 1.2rem; background: #f44336; color: white; border: none; border-radius: 6px; cursor: pointer;">- 1</button>
                        <button id="resetBtn" style="padding: 0.5rem 1.5rem; font-size: 1rem; background: #9e9e9e; color: white; border: none; border-radius: 6px; cursor: pointer;">Reset</button>
                        <button id="incrementBtn" style="padding: 0.5rem 1.5rem; font-size: 1.2rem; background: #4CAF50; color: white; border: none; border-radius: 6px; cursor: pointer;">+ 1</button>
                    </div>
                    <p style="text-align: center; color: #666; margin-top: 0.5rem; font-size: 0.9rem;">Watch the state update cycle in action!</p>
                </div>
                
                <script>
                (function() {
                    const canvas = document.getElementById('useStateCanvas');
                    if (!canvas) return;
                    const ctx = canvas.getContext('2d');
                    
                    let count = 0;
                    let renderCount = 0;
                    let animationPhase = 0;
                    let animationProgress = 0;
                    let stateHistory = [0];
                    
                    function drawRoundedRect(x, y, w, h, r, fill, stroke, strokeWidth = 2) {
                        ctx.beginPath();
                        ctx.roundRect(x, y, w, h, r);
                        if (fill) { ctx.fillStyle = fill; ctx.fill(); }
                        if (stroke) { ctx.strokeStyle = stroke; ctx.lineWidth = strokeWidth; ctx.stroke(); }
                    }
                    
                    function draw() {
                        ctx.clearRect(0, 0, canvas.width, canvas.height);
                        
                        ctx.font = 'bold 16px system-ui';
                        ctx.fillStyle = '#333';
                        ctx.textAlign = 'center';
                        ctx.fillText('useState Re-render Visualization', canvas.width / 2, 25);
                        
                        const compX = 50, compY = 50;
                        drawRoundedRect(compX, compY, 280, 180, 10, '#f8f4ff', '#667eea');
                        ctx.font = 'bold 14px system-ui';
                        ctx.fillStyle = '#667eea';
                        ctx.textAlign = 'left';
                        ctx.fillText('üì¶ Counter Component', compX + 15, compY + 25);
                        
                        drawRoundedRect(compX + 20, compY + 45, 240, 50, 6, 'white', '#ddd', 1);
                        ctx.font = '12px monospace';
                        ctx.fillStyle = '#666';
                        ctx.fillText('const [count, setCount] = useState()', compX + 30, compY + 65);
                        ctx.font = 'bold 20px monospace';
                        ctx.fillStyle = animationPhase > 0 ? '#667eea' : '#333';
                        ctx.fillText('count = ' + count, compX + 30, compY + 88);
                        
                        ctx.font = '11px system-ui';
                        ctx.fillStyle = '#999';
                        ctx.fillText('Renders: ' + renderCount, compX + 20, compY + 170);
                        
                        drawRoundedRect(compX + 20, compY + 105, 240, 50, 6, '#E8F5E9', '#4CAF50', 1);
                        ctx.font = 'bold 24px system-ui';
                        ctx.fillStyle = '#4CAF50';
                        ctx.textAlign = 'center';
                        ctx.fillText('Count: ' + count, compX + 140, compY + 138);
                        
                        const reactX = 420, reactY = 50;
                        drawRoundedRect(reactX, reactY, 280, 180, 10, '#E3F2FD', '#2196F3');
                        ctx.font = 'bold 14px system-ui';
                        ctx.fillStyle = '#1565C0';
                        ctx.textAlign = 'left';
                        ctx.fillText('‚öõÔ∏è React Engine', reactX + 15, reactY + 25);
                        
                        const phases = [
                            { label: '1. setState() called', active: animationPhase >= 1 },
                            { label: '2. Queue update', active: animationPhase >= 2 },
                            { label: '3. Re-render component', active: animationPhase >= 3 },
                            { label: '4. Update DOM', active: animationPhase >= 4 }
                        ];
                        
                        phases.forEach((phase, i) => {
                            const y = reactY + 50 + i * 30;
                            ctx.beginPath();
                            ctx.arc(reactX + 25, y, 10, 0, Math.PI * 2);
                            ctx.fillStyle = phase.active ? '#4CAF50' : '#ddd';
                            ctx.fill();
                            if (phase.active) {
                                ctx.fillStyle = 'white';
                                ctx.font = 'bold 12px system-ui';
                                ctx.textAlign = 'center';
                                ctx.fillText('‚úì', reactX + 25, y + 4);
                            }
                            ctx.font = '12px system-ui';
                            ctx.fillStyle = phase.active ? '#333' : '#999';
                            ctx.textAlign = 'left';
                            ctx.fillText(phase.label, reactX + 45, y + 5);
                        });
                        
                        if (animationPhase > 0 && animationPhase < 4) {
                            const arrowY = 140;
                            const startX = 330, endX = 420;
                            const progress = Math.min(1, animationProgress);
                            const currentX = startX + (endX - startX) * progress;
                            ctx.strokeStyle = '#667eea';
                            ctx.lineWidth = 3;
                            ctx.setLineDash([5, 5]);
                            ctx.beginPath();
                            ctx.moveTo(startX, arrowY);
                            ctx.lineTo(currentX, arrowY);
                            ctx.stroke();
                            ctx.setLineDash([]);
                            if (progress > 0.8) {
                                ctx.beginPath();
                                ctx.moveTo(currentX, arrowY);
                                ctx.lineTo(currentX - 10, arrowY - 6);
                                ctx.lineTo(currentX - 10, arrowY + 6);
                                ctx.closePath();
                                ctx.fillStyle = '#667eea';
                                ctx.fill();
                            }
                        }
                        
                        ctx.fillStyle = '#333';
                        ctx.font = 'bold 12px system-ui';
                        ctx.textAlign = 'left';
                        ctx.fillText('State History:', 50, 260);
                        drawRoundedRect(50, 270, 650, 70, 6, '#fafafa', '#ddd', 1);
                        
                        if (stateHistory.length > 1) {
                            const graphWidth = 630, graphHeight = 50, graphX = 60, graphY = 280;
                            const maxVal = Math.max(Math.abs(Math.min(...stateHistory)), Math.abs(Math.max(...stateHistory)), 5);
                            const midY = graphY + graphHeight / 2;
                            ctx.strokeStyle = '#ddd';
                            ctx.lineWidth = 1;
                            ctx.beginPath();
                            ctx.moveTo(graphX, midY);
                            ctx.lineTo(graphX + graphWidth, midY);
                            ctx.stroke();
                            ctx.strokeStyle = '#667eea';
                            ctx.lineWidth = 2;
                            ctx.beginPath();
                            stateHistory.forEach((val, i) => {
                                const x = graphX + (i / Math.max(stateHistory.length - 1, 1)) * graphWidth;
                                const y = midY - (val / maxVal) * (graphHeight / 2 - 5);
                                if (i === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y);
                            });
                            ctx.stroke();
                            stateHistory.forEach((val, i) => {
                                const x = graphX + (i / Math.max(stateHistory.length - 1, 1)) * graphWidth;
                                const y = midY - (val / maxVal) * (graphHeight / 2 - 5);
                                ctx.beginPath();
                                ctx.arc(x, y, 4, 0, Math.PI * 2);
                                ctx.fillStyle = '#667eea';
                                ctx.fill();
                            });
                        }
                        
                        if (animationPhase > 0 && animationPhase < 5) {
                            animationProgress += 0.05;
                            if (animationProgress >= 1) {
                                animationPhase++;
                                animationProgress = 0;
                                if (animationPhase >= 5) animationPhase = 0;
                            }
                            requestAnimationFrame(draw);
                        }
                    }
                    
                    function triggerUpdate(newCount) {
                        count = newCount;
                        renderCount++;
                        stateHistory.push(count);
                        if (stateHistory.length > 15) stateHistory.shift();
                        animationPhase = 1;
                        animationProgress = 0;
                        draw();
                    }
                    
                    document.getElementById('incrementBtn').addEventListener('click', () => triggerUpdate(count + 1));
                    document.getElementById('decrementBtn').addEventListener('click', () => triggerUpdate(count - 1));
                    document.getElementById('resetBtn').addEventListener('click', () => {
                        stateHistory = [0];
                        renderCount = 0;
                        triggerUpdate(0);
                    });
                    draw();
                })();
                </script>

            <!-- Section 4: Typing State with TypeScript -->
            <section id="section4" class="lesson-section">
                <h2>üìò Typing State with TypeScript</h2>
                <p>One of the great things about using TypeScript with React is that useState is fully type-safe. Let's learn how to properly type your state!</p>

                <h3>Type Inference</h3>
                <div class="card">
                    <h4>TypeScript Infers Simple Types</h4>
                    <p>For primitive values, TypeScript can usually infer the type automatically:</p>
                    <pre><code class="language-typescript">// TypeScript infers these types automatically
const [count, setCount] = useState(0);           // number
const [name, setName] = useState('');            // string
const [isOpen, setIsOpen] = useState(false);     // boolean
const [items, setItems] = useState([]);          // never[] (not useful!)
const [user, setUser] = useState(null);          // null (not useful!)</code></pre>
                    <p>Notice the last two - arrays and null don't infer useful types. We need to be explicit!</p>
                </div>

                <h3>Explicit Type Annotations</h3>
                <div class="card">
                    <h4>Using Generics with useState</h4>
                    <p>For complex types, use TypeScript generics to specify the type:</p>
                    <pre><code class="language-typescript">import { useState } from 'react';

interface User {
    id: number;
    name: string;
    email: string;
}

const UserProfile: React.FC = () => {
    // Explicitly type the state
    const [user, setUser] = useState&lt;User | null&gt;(null);
    const [items, setItems] = useState&lt;string[]&gt;([]);
    const [count, setCount] = useState&lt;number&gt;(0);
    
    return (
        &lt;div&gt;
            {user ? (
                &lt;p&gt;Welcome, {user.name}!&lt;/p&gt;
            ) : (
                &lt;p&gt;Please log in&lt;/p&gt;
            )}
        &lt;/div&gt;
    );
};</code></pre>
                </div>

                <h3>Common Typing Patterns</h3>
                <table>
                    <thead>
                        <tr>
                            <th>State Type</th>
                            <th>TypeScript Syntax</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>String</td>
                            <td><code>useState&lt;string&gt;('')</code></td>
                            <td><code>const [name, setName] = useState&lt;string&gt;('')</code></td>
                        </tr>
                        <tr>
                            <td>Number</td>
                            <td><code>useState&lt;number&gt;(0)</code></td>
                            <td><code>const [age, setAge] = useState&lt;number&gt;(0)</code></td>
                        </tr>
                        <tr>
                            <td>Boolean</td>
                            <td><code>useState&lt;boolean&gt;(false)</code></td>
                            <td><code>const [isOpen, setIsOpen] = useState&lt;boolean&gt;(false)</code></td>
                        </tr>
                        <tr>
                            <td>Array</td>
                            <td><code>useState&lt;Type[]&gt;([])</code></td>
                            <td><code>const [items, setItems] = useState&lt;string[]&gt;([])</code></td>
                        </tr>
                        <tr>
                            <td>Object</td>
                            <td><code>useState&lt;Interface&gt;(obj)</code></td>
                            <td><code>const [user, setUser] = useState&lt;User&gt;(initialUser)</code></td>
                        </tr>
                        <tr>
                            <td>Nullable</td>
                            <td><code>useState&lt;Type | null&gt;(null)</code></td>
                            <td><code>const [user, setUser] = useState&lt;User | null&gt;(null)</code></td>
                        </tr>
                        <tr>
                            <td>Union Types</td>
                            <td><code>useState&lt;'A' | 'B'&gt;('A')</code></td>
                            <td><code>const [status, setStatus] = useState&lt;'idle' | 'loading'&gt;('idle')</code></td>
                        </tr>
                    </tbody>
                </table>

                <h3>Type-Safe State Updates</h3>
                <div class="card">
                    <h4>TypeScript Checks Your Updates</h4>
                    <pre><code class="language-typescript">interface Todo {
    id: number;
    text: string;
    completed: boolean;
}

const TodoList: React.FC = () => {
    const [todos, setTodos] = useState&lt;Todo[]&gt;([]);
    
    const addTodo = (text: string) => {
        const newTodo: Todo = {
            id: Date.now(),
            text: text,
            completed: false
        };
        
        // ‚úÖ TypeScript knows this is correct
        setTodos([...todos, newTodo]);
        
        // ‚ùå TypeScript error - wrong type!
        // setTodos([...todos, { text: 'incomplete' }]);
        
        // ‚ùå TypeScript error - can't assign string to Todo[]
        // setTodos('not an array');
    };
    
    return &lt;div&gt;{/* JSX */}&lt;/div&gt;;
};</code></pre>
                </div>

                <div class="card" style="background: #e8f5e9; border-left: 4px solid #4CAF50;">
                    <h4>‚úÖ Pro Tip: When to Be Explicit</h4>
                    <p>Use explicit type annotations when:</p>
                    <ul>
                        <li>Working with arrays (otherwise you get <code>never[]</code>)</li>
                        <li>Initial value is <code>null</code> or <code>undefined</code></li>
                        <li>Using complex objects or interfaces</li>
                        <li>You want to be extra clear about the type</li>
                    </ul>
                    <p>For simple primitives with non-null initial values, type inference works great!</p>
                </div>
            </section>

            <!-- Section 5: Updating State Correctly -->
            <section id="section5" class="lesson-section">
                <h2>‚úèÔ∏è Updating State Correctly</h2>
                <p>Understanding how to update state correctly is crucial. There are some important rules and patterns you need to know!</p>

                <h3>State Updates are Asynchronous</h3>
                <div class="card" style="background-color: #fff3cd; border-left: 4px solid #ffc107;">
                    <h4>‚ö†Ô∏è Important: State Updates Don't Happen Immediately</h4>
                    <p>When you call <code>setState</code>, React doesn't update the state right away. It schedules an update for the next render.</p>
                    <pre><code class="language-typescript">const [count, setCount] = useState(0);

const handleClick = () => {
    setCount(count + 1);
    console.log(count);  // ‚ö†Ô∏è Still 0! Not updated yet!
    
    // This won't work as expected
    setCount(count + 1);  // Still using old count (0)
    setCount(count + 1);  // Still using old count (0)
    // Result: count becomes 1, not 3!
};</code></pre>
                </div>

                <h3>State is Immutable</h3>
                <div class="card">
                    <h4>Never Mutate State Directly</h4>
                    <p>State should be treated as read-only. Always create new values instead of modifying existing ones:</p>
                    
                    <pre><code class="language-typescript">const [count, setCount] = useState(0);

// ‚ùå WRONG - Don't do this!
count = count + 1;  // Error: can't reassign const
count++;            // Error: can't reassign const

// ‚úÖ CORRECT - Use the setter function
setCount(count + 1);


const [user, setUser] = useState({ name: 'Alice', age: 25 });

// ‚ùå WRONG - Don't mutate the object directly
user.age = 26;              // Mutation! Won't trigger re-render
setUser(user);              // Still wrong - same object reference

// ‚úÖ CORRECT - Create a new object
setUser({ ...user, age: 26 });


const [items, setItems] = useState(['a', 'b', 'c']);

// ‚ùå WRONG - Don't mutate the array directly
items.push('d');            // Mutation! Won't trigger re-render
setItems(items);            // Still wrong - same array reference

// ‚úÖ CORRECT - Create a new array
setItems([...items, 'd']);</code></pre>
                </div>

                <h3>Why Immutability Matters</h3>
                <pre class="mermaid">
graph TD
    A[setState called] --> B{Did reference change?}
    B -->|Yes - New object/array| C[React re-renders]
    B -->|No - Same reference| D[React skips re-render]
    
    C --> E[UI updates ‚úÖ]
    D --> F[UI doesn't update ‚ùå]
    
    style C fill:#4CAF50,color:#fff
    style D fill:#f44336,color:#fff
    style E fill:#4CAF50,color:#fff
    style F fill:#f44336,color:#fff
</pre>

                <p>React uses reference equality (===) to check if state changed. If you mutate the original object/array, it's still the same reference, so React won't detect the change!</p>

                <h3>üîç Reference Equality Explained</h3>
                <p>React uses reference equality (===) to detect changes. Here's why mutation doesn't work:</p>
                
                <svg viewBox="0 0 800 380" style="width: 100%; max-width: 800px; height: auto; margin: 2rem auto; display: block; font-family: system-ui, sans-serif;">
                    <defs>
                        <linearGradient id="wrongGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#f44336"/>
                            <stop offset="100%" style="stop-color:#e57373"/>
                        </linearGradient>
                        <linearGradient id="rightGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#4CAF50"/>
                            <stop offset="100%" style="stop-color:#81C784"/>
                        </linearGradient>
                    </defs>
                    
                    <text x="400" y="25" text-anchor="middle" fill="#333" font-weight="bold" font-size="16">Why Mutation Doesn't Trigger Re-renders</text>
                    
                    <!-- WRONG WAY -->
                    <g transform="translate(20, 45)">
                        <rect x="0" y="0" width="370" height="310" rx="10" fill="#FFEBEE" stroke="#f44336" stroke-width="2"/>
                        <rect x="0" y="0" width="370" height="40" rx="10" fill="url(#wrongGrad)"/>
                        <text x="185" y="27" text-anchor="middle" fill="white" font-weight="bold" font-size="14">‚ùå Mutation (WRONG)</text>
                        
                        <text x="20" y="70" fill="#333" font-size="12" font-weight="bold">Memory Address: 0x1234</text>
                        
                        <rect x="20" y="85" width="150" height="80" rx="6" fill="white" stroke="#f44336" stroke-width="2"/>
                        <text x="95" y="105" text-anchor="middle" fill="#333" font-size="11" font-weight="bold">user object</text>
                        <text x="30" y="125" fill="#666" font-size="10">name: "Alice"</text>
                        <text x="30" y="145" fill="#666" font-size="10">age: 25 ‚Üí 26</text>
                        <text x="95" y="160" text-anchor="middle" fill="#f44336" font-size="9">(mutated in place)</text>
                        
                        <path d="M170 125 L200 125" stroke="#f44336" stroke-width="2"/>
                        <text x="205" y="125" fill="#f44336" font-size="10">same ref</text>
                        
                        <rect x="20" y="180" width="330" height="35" rx="4" fill="#fff" stroke="#ddd"/>
                        <text x="185" y="202" text-anchor="middle" fill="#333" font-size="11" font-family="monospace">user.age = 26; setUser(user);</text>
                        
                        <rect x="20" y="230" width="330" height="60" rx="6" fill="#ffcdd2"/>
                        <text x="185" y="250" text-anchor="middle" fill="#c62828" font-size="11" font-weight="bold">React checks: oldRef === newRef?</text>
                        <text x="185" y="270" text-anchor="middle" fill="#c62828" font-size="12" font-weight="bold">0x1234 === 0x1234 ‚Üí TRUE</text>
                        <text x="185" y="285" text-anchor="middle" fill="#c62828" font-size="10">"No change detected!" ‚Üí Skip re-render</text>
                    </g>
                    
                    <!-- RIGHT WAY -->
                    <g transform="translate(410, 45)">
                        <rect x="0" y="0" width="370" height="310" rx="10" fill="#E8F5E9" stroke="#4CAF50" stroke-width="2"/>
                        <rect x="0" y="0" width="370" height="40" rx="10" fill="url(#rightGrad)"/>
                        <text x="185" y="27" text-anchor="middle" fill="white" font-weight="bold" font-size="14">‚úÖ New Object (CORRECT)</text>
                        
                        <text x="20" y="70" fill="#333" font-size="12" font-weight="bold">Memory Addresses:</text>
                        
                        <rect x="20" y="85" width="130" height="70" rx="6" fill="white" stroke="#9e9e9e" stroke-width="1" stroke-dasharray="4"/>
                        <text x="85" y="105" text-anchor="middle" fill="#999" font-size="10">old: 0x1234</text>
                        <text x="30" y="125" fill="#999" font-size="10">name: "Alice"</text>
                        <text x="30" y="142" fill="#999" font-size="10">age: 25</text>
                        
                        <rect x="180" y="85" width="130" height="70" rx="6" fill="white" stroke="#4CAF50" stroke-width="2"/>
                        <text x="245" y="105" text-anchor="middle" fill="#4CAF50" font-size="10" font-weight="bold">new: 0x5678</text>
                        <text x="190" y="125" fill="#333" font-size="10">name: "Alice"</text>
                        <text x="190" y="142" fill="#4CAF50" font-size="10" font-weight="bold">age: 26</text>
                        
                        <rect x="20" y="180" width="330" height="35" rx="4" fill="#fff" stroke="#ddd"/>
                        <text x="185" y="202" text-anchor="middle" fill="#333" font-size="11" font-family="monospace">setUser({ ...user, age: 26 });</text>
                        
                        <rect x="20" y="230" width="330" height="60" rx="6" fill="#c8e6c9"/>
                        <text x="185" y="250" text-anchor="middle" fill="#2E7D32" font-size="11" font-weight="bold">React checks: oldRef === newRef?</text>
                        <text x="185" y="270" text-anchor="middle" fill="#2E7D32" font-size="12" font-weight="bold">0x1234 === 0x5678 ‚Üí FALSE</text>
                        <text x="185" y="285" text-anchor="middle" fill="#2E7D32" font-size="10">"Change detected!" ‚Üí Re-render! ‚úÖ</text>
                    </g>
                </svg>

                <h3>Multiple Updates in One Event</h3>
                <div class="card">
                    <h4>React Batches Updates</h4>
                    <p>React batches multiple state updates in the same event handler for performance:</p>
                    <pre><code class="language-typescript">const [count, setCount] = useState(0);
const [flag, setFlag] = useState(false);

const handleClick = () => {
    setCount(count + 1);    // Doesn't re-render yet
    setFlag(!flag);          // Doesn't re-render yet
    // React batches these and re-renders once after the function completes
};

// Result: One re-render with both updates applied ‚úÖ</code></pre>
                </div>

                <div class="card" style="background: #e3f2fd; border-left: 4px solid #2196F3;">
                    <h4>üí° Mental Model</h4>
                    <p>Think of state updates like ordering at a restaurant:</p>
                    <ul>
                        <li>You tell the waiter what you want (call setState)</li>
                        <li>The waiter writes it down (React queues the update)</li>
                        <li>After everyone at the table orders (event handler completes)</li>
                        <li>The waiter brings everything at once (React re-renders with all updates)</li>
                    </ul>
                    <p>This is more efficient than bringing one item at a time!</p>
                </div>
            </section>

            <!-- Section 6: State with Objects -->
            <section id="section6" class="lesson-section">
                <h2>üéÅ State with Objects</h2>
                <p>Working with objects in state requires special care. You need to create new objects instead of modifying existing ones.</p>

                <h3>Basic Object State</h3>
                <div class="card">
                    <h4>Updating Object Properties</h4>
                    <pre><code class="language-typescript">interface User {
    name: string;
    email: string;
    age: number;
}

const UserForm: React.FC = () => {
    const [user, setUser] = useState&lt;User&gt;({
        name: '',
        email: '',
        age: 0
    });

    // Update a single property
    const updateName = (newName: string) => {
        setUser({
            ...user,        // Copy all existing properties
            name: newName   // Override the name property
        });
    };

    // Update multiple properties
    const updateUser = (name: string, email: string) => {
        setUser({
            ...user,
            name: name,
            email: email
        });
    };

    return (
        &lt;div&gt;
            &lt;input 
                value={user.name}
                onChange={(e) => setUser({ ...user, name: e.target.value })}
            /&gt;
            &lt;input 
                value={user.email}
                onChange={(e) => setUser({ ...user, email: e.target.value })}
            /&gt;
        &lt;/div&gt;
    );
};</code></pre>
                </div>

                <h3>Nested Objects</h3>
                <div class="card">
                    <h4>Updating Nested Properties</h4>
                    <p>For nested objects, you need to copy at each level:</p>
                    <pre><code class="language-typescript">interface Address {
    street: string;
    city: string;
    zipCode: string;
}

interface User {
    name: string;
    address: Address;
}

const UserProfile: React.FC = () => {
    const [user, setUser] = useState&lt;User&gt;({
        name: 'Alice',
        address: {
            street: '123 Main St',
            city: 'Boston',
            zipCode: '02101'
        }
    });

    // ‚ùå WRONG - This mutates the nested object
    const updateCityWrong = (newCity: string) => {
        user.address.city = newCity;
        setUser(user);
    };

    // ‚úÖ CORRECT - Copy both levels
    const updateCity = (newCity: string) => {
        setUser({
            ...user,                    // Copy user
            address: {
                ...user.address,        // Copy address
                city: newCity           // Update city
            }
        });
    };

    return (
        &lt;div&gt;
            &lt;input 
                value={user.address.city}
                onChange={(e) => updateCity(e.target.value)}
            /&gt;
        &lt;/div&gt;
    );
};</code></pre>
                </div>

                <h3>Patterns for Object Updates</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Operation</th>
                            <th>Pattern</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Update one property</td>
                            <td><code>setObj({ ...obj, key: newValue })</code></td>
                        </tr>
                        <tr>
                            <td>Update multiple properties</td>
                            <td><code>setObj({ ...obj, key1: val1, key2: val2 })</code></td>
                        </tr>
                        <tr>
                            <td>Update nested property</td>
                            <td><code>setObj({ ...obj, nested: { ...obj.nested, key: val } })</code></td>
                        </tr>
                        <tr>
                            <td>Replace entire object</td>
                            <td><code>setObj(newObject)</code></td>
                        </tr>
                        <tr>
                            <td>Reset to initial</td>
                            <td><code>setObj(initialState)</code></td>
                        </tr>
                    </tbody>
                </table>

                <div class="card" style="background: #e8f5e9; border-left: 4px solid #4CAF50;">
                    <h4>‚úÖ Pro Tip: Helper Function Pattern</h4>
                    <p>For complex updates, create helper functions:</p>
                    <pre><code class="language-typescript">const updateUserField = (field: keyof User, value: any) => {
    setUser({ ...user, [field]: value });
};

// Usage:
updateUserField('name', 'Bob');
updateUserField('email', '<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="e7858885a7829f868a978b82c984888a">[email&#160;protected]</a>');</code></pre>
                </div>
            </section>

            <!-- Section 7: State with Arrays -->
            <section id="section7" class="lesson-section">
                <h2>üìö State with Arrays</h2>
                <p>Arrays in state also require immutable updates. Let's learn all the common array operations!</p>

                <h3>Adding Items</h3>
                <div class="card">
                    <h4>Adding to Arrays</h4>
                    <pre><code class="language-typescript">const [items, setItems] = useState&lt;string[]&gt;([]);

// Add to end
setItems([...items, 'new item']);

// Add to beginning
setItems(['new item', ...items]);

// Add at specific index
const index = 2;
setItems([
    ...items.slice(0, index),
    'new item',
    ...items.slice(index)
]);</code></pre>
                </div>

                <h3>Removing Items</h3>
                <div class="card">
                    <h4>Removing from Arrays</h4>
                    <pre><code class="language-typescript">const [items, setItems] = useState&lt;string[]&gt;(['a', 'b', 'c']);

// Remove by index
const removeAtIndex = (indexToRemove: number) => {
    setItems(items.filter((_, index) => index !== indexToRemove));
};

// Remove by value
const removeByValue = (valueToRemove: string) => {
    setItems(items.filter(item => item !== valueToRemove));
};

// Remove first item
setItems(items.slice(1));

// Remove last item
setItems(items.slice(0, -1));</code></pre>
                </div>

                <h3>Updating Items</h3>
                <div class="card">
                    <h4>Modifying Array Items</h4>
                    <pre><code class="language-typescript">interface Todo {
    id: number;
    text: string;
    completed: boolean;
}

const [todos, setTodos] = useState&lt;Todo[]&gt;([]);

// Update item by id
const toggleTodo = (id: number) => {
    setTodos(todos.map(todo =>
        todo.id === id 
            ? { ...todo, completed: !todo.completed }
            : todo
    ));
};

// Update item at index
const updateAtIndex = (index: number, newText: string) => {
    setTodos(todos.map((todo, i) =>
        i === index
            ? { ...todo, text: newText }
            : todo
    ));
};</code></pre>
                </div>

                <h3>Common Array Operations</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Operation</th>
                            <th>Pattern</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Add to end</td>
                            <td><code>[...arr, newItem]</code></td>
                            <td>Like push()</td>
                        </tr>
                        <tr>
                            <td>Add to start</td>
                            <td><code>[newItem, ...arr]</code></td>
                            <td>Like unshift()</td>
                        </tr>
                        <tr>
                            <td>Remove</td>
                            <td><code>arr.filter(item => condition)</code></td>
                            <td>Returns new array</td>
                        </tr>
                        <tr>
                            <td>Update</td>
                            <td><code>arr.map(item => condition ? newItem : item)</code></td>
                            <td>Returns new array</td>
                        </tr>
                        <tr>
                            <td>Replace all</td>
                            <td><code>setArr(newArray)</code></td>
                            <td>Complete replacement</td>
                        </tr>
                        <tr>
                            <td>Clear all</td>
                            <td><code>setArr([])</code></td>
                            <td>Empty array</td>
                        </tr>
                        <tr>
                            <td>Sort</td>
                            <td><code>[...arr].sort()</code></td>
                            <td>Copy first! sort() mutates</td>
                        </tr>
                        <tr>
                            <td>Reverse</td>
                            <td><code>[...arr].reverse()</code></td>
                            <td>Copy first! reverse() mutates</td>
                        </tr>
                    </tbody>
                </table>

                <div class="card" style="background-color: #fff3cd; border-left: 4px solid #ffc107;">

                <h3>üéÆ Interactive Demo: Array State Operations</h3>
                <p>See how immutable array operations work in real-time:</p>
                
                <div style="background: #f8f9fa; border-radius: 12px; padding: 1.5rem; margin: 1.5rem 0;">
                    <canvas id="arrayOpsCanvas" width="750" height="320" style="width: 100%; max-width: 750px; display: block; margin: 0 auto; border: 1px solid #ddd; border-radius: 8px; background: white;"></canvas>
                    <div style="display: flex; justify-content: center; gap: 0.5rem; margin-top: 1rem; flex-wrap: wrap;">
                        <button id="addItemBtn" style="padding: 0.4rem 1rem; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">Add Item</button>
                        <button id="removeLastBtn" style="padding: 0.4rem 1rem; background: #f44336; color: white; border: none; border-radius: 4px; cursor: pointer;">Remove Last</button>
                        <button id="toggleFirstBtn" style="padding: 0.4rem 1rem; background: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer;">Toggle First</button>
                        <button id="clearAllBtn" style="padding: 0.4rem 1rem; background: #9e9e9e; color: white; border: none; border-radius: 4px; cursor: pointer;">Clear All</button>
                    </div>
                </div>
                
                <script>
                (function() {
                    const canvas = document.getElementById('arrayOpsCanvas');
                    if (!canvas) return;
                    const ctx = canvas.getContext('2d');
                    
                    let items = [
                        { id: 1, text: 'Learn React', done: false },
                        { id: 2, text: 'Master useState', done: true },
                        { id: 3, text: 'Build Apps', done: false }
                    ];
                    let nextId = 4;
                    let lastOperation = '';
                    let codeDisplay = '// Click a button to see the code';
                    
                    function draw() {
                        ctx.clearRect(0, 0, canvas.width, canvas.height);
                        
                        ctx.font = 'bold 16px system-ui';
                        ctx.fillStyle = '#333';
                        ctx.textAlign = 'center';
                        ctx.fillText('Array State: Todo List Demo', canvas.width / 2, 25);
                        
                        ctx.beginPath();
                        ctx.roundRect(30, 45, 350, 230, 8);
                        ctx.fillStyle = '#f5f5f5';
                        ctx.fill();
                        ctx.strokeStyle = '#ddd';
                        ctx.stroke();
                        
                        ctx.font = 'bold 12px system-ui';
                        ctx.fillStyle = '#667eea';
                        ctx.textAlign = 'left';
                        ctx.fillText('todos state array:', 45, 65);
                        
                        if (items.length === 0) {
                            ctx.font = '14px system-ui';
                            ctx.fillStyle = '#999';
                            ctx.textAlign = 'center';
                            ctx.fillText('[ ] (empty array)', 205, 150);
                        } else {
                            items.forEach((item, i) => {
                                const y = 80 + i * 45;
                                ctx.beginPath();
                                ctx.roundRect(45, y, 320, 38, 6);
                                ctx.fillStyle = item.done ? '#E8F5E9' : 'white';
                                ctx.fill();
                                ctx.strokeStyle = item.done ? '#4CAF50' : '#ddd';
                                ctx.lineWidth = 1;
                                ctx.stroke();
                                
                                ctx.beginPath();
                                ctx.roundRect(55, y + 9, 20, 20, 3);
                                ctx.fillStyle = item.done ? '#4CAF50' : 'white';
                                ctx.fill();
                                ctx.strokeStyle = item.done ? '#4CAF50' : '#ccc';
                                ctx.stroke();
                                
                                if (item.done) {
                                    ctx.font = 'bold 14px system-ui';
                                    ctx.fillStyle = 'white';
                                    ctx.textAlign = 'center';
                                    ctx.fillText('‚úì', 65, y + 24);
                                }
                                
                                ctx.font = '13px system-ui';
                                ctx.fillStyle = item.done ? '#666' : '#333';
                                ctx.textAlign = 'left';
                                ctx.fillText(item.text, 85, y + 24);
                                
                                ctx.font = '10px monospace';
                                ctx.fillStyle = '#999';
                                ctx.fillText('id:' + item.id, 300, y + 24);
                            });
                        }
                        
                        ctx.beginPath();
                        ctx.roundRect(400, 45, 330, 230, 8);
                        ctx.fillStyle = '#1e1e1e';
                        ctx.fill();
                        
                        ctx.font = 'bold 12px system-ui';
                        ctx.fillStyle = '#4CAF50';
                        ctx.textAlign = 'left';
                        ctx.fillText('Code executed:', 415, 65);
                        
                        ctx.font = '11px monospace';
                        ctx.fillStyle = '#e0e0e0';
                        const lines = codeDisplay.split('\n');
                        lines.forEach((line, i) => {
                            let color = '#e0e0e0';
                            if (line.includes('//')) color = '#6A9955';
                            else if (line.includes('setTodos')) color = '#DCDCAA';
                            else if (line.includes('...')) color = '#569CD6';
                            else if (line.includes('filter') || line.includes('map')) color = '#C586C0';
                            ctx.fillStyle = color;
                            ctx.fillText(line, 415, 90 + i * 18);
                        });
                        
                        if (lastOperation) {
                            ctx.fillStyle = '#667eea';
                            ctx.font = 'bold 11px system-ui';
                            ctx.fillText('Last: ' + lastOperation, 415, 260);
                        }
                    }
                    
                    document.getElementById('addItemBtn').addEventListener('click', () => {
                        const newItem = { id: nextId++, text: 'New Task #' + (nextId - 1), done: false };
                        items = [...items, newItem];
                        lastOperation = 'Add Item';
                        codeDisplay = '// Add to end of array\nconst newTodo = {\n  id: ' + newItem.id + ',\n  text: "' + newItem.text + '",\n  done: false\n};\n\nsetTodos([...todos, newTodo]);';
                        draw();
                    });
                    
                    document.getElementById('removeLastBtn').addEventListener('click', () => {
                        if (items.length > 0) {
                            items = items.slice(0, -1);
                            lastOperation = 'Remove Last';
                            codeDisplay = '// Remove last item\nsetTodos(todos.slice(0, -1));\n\n// Or with filter:\nsetTodos(\n  todos.filter((_, i) =>\n    i !== todos.length - 1\n  )\n);';
                        }
                        draw();
                    });
                    
                    document.getElementById('toggleFirstBtn').addEventListener('click', () => {
                        if (items.length > 0) {
                            items = items.map((item, i) => 
                                i === 0 ? { ...item, done: !item.done } : item
                            );
                            lastOperation = 'Toggle First';
                            codeDisplay = '// Toggle first item\nsetTodos(todos.map((todo, i) =>\n  i === 0\n    ? { ...todo, done: !todo.done }\n    : todo\n));';
                        }
                        draw();
                    });
                    
                    document.getElementById('clearAllBtn').addEventListener('click', () => {
                        items = [];
                        lastOperation = 'Clear All';
                        codeDisplay = '// Clear all items\nsetTodos([]);\n\n// Creates new empty array\n// reference, triggering\n// re-render';
                        draw();
                    });
                    
                    draw();
                })();
                </script>
                    <h4>‚ö†Ô∏è Watch Out: Mutating Methods</h4>
                    <p>These array methods mutate the original array - don't use them directly on state:</p>
                    <ul>
                        <li><code>push()</code>, <code>pop()</code>, <code>shift()</code>, <code>unshift()</code></li>
                        <li><code>splice()</code></li>
                        <li><code>sort()</code>, <code>reverse()</code></li>
                    </ul>
                    <p>Always create a copy first if you need to use these!</p>
                </div>

                <h3>Complete Todo List Example</h3>
                <div class="card">
                    <h4>Putting It All Together</h4>
                    <pre><code class="language-typescript">import React, { useState } from 'react';

interface Todo {
    id: number;
    text: string;
    completed: boolean;
}

const TodoList: React.FC = () => {
    const [todos, setTodos] = useState&lt;Todo[]&gt;([]);
    const [inputText, setInputText] = useState('');

    // Add new todo
    const addTodo = () => {
        if (inputText.trim()) {
            setTodos([...todos, {
                id: Date.now(),
                text: inputText,
                completed: false
            }]);
            setInputText('');
        }
    };

    // Toggle completion
    const toggleTodo = (id: number) => {
        setTodos(todos.map(todo =>
            todo.id === id
                ? { ...todo, completed: !todo.completed }
                : todo
        ));
    };

    // Delete todo
    const deleteTodo = (id: number) => {
        setTodos(todos.filter(todo => todo.id !== id));
    };

    return (
        &lt;div&gt;
            &lt;input 
                value={inputText}
                onChange={(e) => setInputText(e.target.value)}
                onKeyPress={(e) => e.key === 'Enter' && addTodo()}
            /&gt;
            &lt;button onClick={addTodo}&gt;Add&lt;/button&gt;

            &lt;ul&gt;
                {todos.map(todo => (
                    &lt;li key={todo.id}&gt;
                        &lt;input 
                            type="checkbox"
                            checked={todo.completed}
                            onChange={() => toggleTodo(todo.id)}
                        /&gt;
                        &lt;span style={{
                            textDecoration: todo.completed ? 'line-through' : 'none'
                        }}&gt;
                            {todo.text}
                        &lt;/span&gt;
                        &lt;button onClick={() => deleteTodo(todo.id)}&gt;
                            Delete
                        &lt;/button&gt;
                    &lt;/li&gt;
                ))}
            &lt;/ul&gt;
        &lt;/div&gt;
    );
};

export default TodoList;</code></pre>
                </div>
            </section>

            <!-- Section 8: Functional Updates -->
            <section id="section8" class="lesson-section">
                <h2>‚öôÔ∏è Functional Updates</h2>
                <p>Sometimes you need to update state based on the previous state value. There's a special pattern for this!</p>

                <h3>The Problem with Direct Updates</h3>
                <div class="card" style="background-color: #fff3cd; border-left: 4px solid #ffc107;">
                    <h4>‚ö†Ô∏è This Can Go Wrong</h4>
                    <pre><code class="language-typescript">const [count, setCount] = useState(0);

const increment = () => {
    setCount(count + 1);
    setCount(count + 1);
    setCount(count + 1);
    // You might expect count to be 3, but it will be 1!
    // All three updates use the same old value of count
};</code></pre>
                </div>

                <h3>The Solution: Functional Updates</h3>
                <div class="card">
                    <h4>Pass a Function to setState</h4>
                    <p>Instead of passing the new value, pass a function that receives the previous value:</p>
                    <pre><code class="language-typescript">const [count, setCount] = useState(0);

// ‚úÖ CORRECT - Use functional update
const increment = () => {
    setCount(prevCount => prevCount + 1);
    setCount(prevCount => prevCount + 1);
    setCount(prevCount => prevCount + 1);
    // Now count will be 3! ‚úÖ
};

// The pattern:
setCount(previousValue => newValue);</code></pre>
                </div>

                <h3>When to Use Functional Updates</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Situation</th>
                            <th>Use Functional Update?</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>New state depends on old state</td>
                            <td>‚úÖ Yes</td>
                        </tr>
                        <tr>
                            <td>Multiple updates in same function</td>
                            <td>‚úÖ Yes</td>
                        </tr>
                        <tr>
                            <td>Update in useEffect or callback</td>
                            <td>‚úÖ Yes (safer)</td>
                        </tr>
                        <tr>
                            <td>Setting to a specific value</td>
                            <td>‚ùå No, direct is fine</td>
                        </tr>
                    </tbody>
                </table>


                <h3>üîÑ The Stale Closure Problem Visualized</h3>
                <p>This diagram shows why functional updates are essential when making multiple updates:</p>
                
                <svg viewBox="0 0 800 400" style="width: 100%; max-width: 800px; height: auto; margin: 2rem auto; display: block; font-family: system-ui, sans-serif;">
                    <text x="400" y="25" text-anchor="middle" fill="#333" font-weight="bold" font-size="16">Direct Updates vs Functional Updates</text>
                    
                    <!-- Direct Updates (Wrong) -->
                    <g transform="translate(20, 50)">
                        <rect x="0" y="0" width="370" height="330" rx="10" fill="#FFEBEE" stroke="#f44336" stroke-width="2"/>
                        <rect x="0" y="0" width="370" height="40" rx="10" fill="#f44336"/>
                        <text x="185" y="27" text-anchor="middle" fill="white" font-weight="bold" font-size="14">‚ùå Direct Updates (Stale Closure)</text>
                        
                        <rect x="20" y="55" width="80" height="35" rx="4" fill="#fff" stroke="#ddd"/>
                        <text x="60" y="77" text-anchor="middle" fill="#333" font-size="11" font-weight="bold">count = 0</text>
                        <text x="120" y="75" fill="#f44336" font-size="10">‚Üê captured at render</text>
                        
                        <rect x="20" y="100" width="330" height="30" rx="4" fill="#fff3e0" stroke="#FF9800"/>
                        <text x="35" y="120" fill="#333" font-size="11" font-family="monospace">setCount(count + 1)</text>
                        <text x="240" y="120" fill="#666" font-size="10">// count is 0 ‚Üí sets to 1</text>
                        
                        <rect x="20" y="140" width="330" height="30" rx="4" fill="#fff3e0" stroke="#FF9800"/>
                        <text x="35" y="160" fill="#333" font-size="11" font-family="monospace">setCount(count + 1)</text>
                        <text x="240" y="160" fill="#666" font-size="10">// count is 0 ‚Üí sets to 1</text>
                        
                        <rect x="20" y="180" width="330" height="30" rx="4" fill="#fff3e0" stroke="#FF9800"/>
                        <text x="35" y="200" fill="#333" font-size="11" font-family="monospace">setCount(count + 1)</text>
                        <text x="240" y="200" fill="#666" font-size="10">// count is 0 ‚Üí sets to 1</text>
                        
                        <text x="185" y="235" text-anchor="middle" fill="#E65100" font-size="10">React batches: only last value (1) is used</text>
                        
                        <rect x="20" y="250" width="330" height="60" rx="6" fill="#ffcdd2"/>
                        <text x="185" y="275" text-anchor="middle" fill="#c62828" font-size="14" font-weight="bold">Result: count = 1</text>
                        <text x="185" y="295" text-anchor="middle" fill="#c62828" font-size="11">Expected 3, got 1! ‚ùå</text>
                    </g>
                    
                    <!-- Functional Updates (Correct) -->
                    <g transform="translate(410, 50)">
                        <rect x="0" y="0" width="370" height="330" rx="10" fill="#E8F5E9" stroke="#4CAF50" stroke-width="2"/>
                        <rect x="0" y="0" width="370" height="40" rx="10" fill="#4CAF50"/>
                        <text x="185" y="27" text-anchor="middle" fill="white" font-weight="bold" font-size="14">‚úÖ Functional Updates</text>
                        
                        <rect x="20" y="55" width="80" height="35" rx="4" fill="#fff" stroke="#ddd"/>
                        <text x="60" y="77" text-anchor="middle" fill="#333" font-size="11" font-weight="bold">count = 0</text>
                        <text x="120" y="75" fill="#4CAF50" font-size="10">‚Üê gets fresh each time</text>
                        
                        <rect x="20" y="100" width="330" height="30" rx="4" fill="#E8F5E9" stroke="#4CAF50"/>
                        <text x="35" y="120" fill="#333" font-size="11" font-family="monospace">setCount(prev => prev + 1)</text>
                        <text x="270" y="120" fill="#2E7D32" font-size="10">// 0 ‚Üí 1</text>
                        
                        <rect x="20" y="140" width="330" height="30" rx="4" fill="#E8F5E9" stroke="#4CAF50"/>
                        <text x="35" y="160" fill="#333" font-size="11" font-family="monospace">setCount(prev => prev + 1)</text>
                        <text x="270" y="160" fill="#2E7D32" font-size="10">// 1 ‚Üí 2</text>
                        
                        <rect x="20" y="180" width="330" height="30" rx="4" fill="#E8F5E9" stroke="#4CAF50"/>
                        <text x="35" y="200" fill="#333" font-size="11" font-family="monospace">setCount(prev => prev + 1)</text>
                        <text x="270" y="200" fill="#2E7D32" font-size="10">// 2 ‚Üí 3</text>
                        
                        <text x="185" y="235" text-anchor="middle" fill="#2E7D32" font-size="10">React chains: each update uses previous result</text>
                        
                        <rect x="20" y="250" width="330" height="60" rx="6" fill="#c8e6c9"/>
                        <text x="185" y="275" text-anchor="middle" fill="#2E7D32" font-size="14" font-weight="bold">Result: count = 3</text>
                        <text x="185" y="295" text-anchor="middle" fill="#2E7D32" font-size="11">All updates applied correctly! ‚úÖ</text>
                    </g>
                </svg>
                
                <div class="card" style="background: #e3f2fd; border-left: 4px solid #2196F3;">
                    <h4>üí° When to Use Each Pattern</h4>
                    <table style="width: 100%; margin-top: 0.5rem;">
                        <tr>
                            <td style="padding: 0.5rem;"><code>setCount(count + 1)</code></td>
                            <td style="padding: 0.5rem;">Fine for single updates based on events</td>
                        </tr>
                        <tr>
                            <td style="padding: 0.5rem;"><code>setCount(prev => prev + 1)</code></td>
                            <td style="padding: 0.5rem;"><strong>Required</strong> for multiple updates, or in callbacks/effects</td>
                        </tr>
                    </table>
                </div>
                <h3>Examples with Different Types</h3>
                <div class="card">
                    <h4>Functional Updates for Various State Types</h4>
                    <pre><code class="language-typescript">// Numbers
const [count, setCount] = useState(0);
setCount(prev => prev + 1);
setCount(prev => prev * 2);

// Booleans
const [isOpen, setIsOpen] = useState(false);
setIsOpen(prev => !prev);

// Strings
const [text, setText] = useState('');
setText(prev => prev + ' more text');

// Objects
const [user, setUser] = useState({ name: '', age: 0 });
setUser(prev => ({ ...prev, age: prev.age + 1 }));

// Arrays
const [items, setItems] = useState&lt;number[]&gt;([]);
setItems(prev => [...prev, prev.length + 1]);
setItems(prev => prev.filter(item => item > 5));
setItems(prev => prev.map(item => item * 2));</code></pre>
                </div>

                <div class="card" style="background: #e8f5e9; border-left: 4px solid #4CAF50;">
                    <h4>‚úÖ Best Practice</h4>
                    <p>When in doubt, use functional updates! They're always safe and often more correct than direct updates. The convention is to name the parameter <code>prev</code> or <code>previous</code> followed by the state name:</p>
                    <pre><code class="language-typescript">setCount(prevCount => prevCount + 1);
setUser(prevUser => ({ ...prevUser, name: 'New' }));
setItems(prevItems => [...prevItems, newItem]);</code></pre>
                </div>
            </section>

            <!-- Section 9: Hands-on Practice -->
            <section id="section9" class="lesson-section">
                <h2>üèãÔ∏è Hands-on Practice</h2>
                <p>Time to apply what you've learned! Let's build some practical components using useState.</p>

                <div class="card" style="background: #e3f2fd; border-left: 4px solid #2196F3;">
                    <h3>üèãÔ∏è Exercise 1: Enhanced Counter</h3>
                    <p><strong>Goal:</strong> Build a counter with increment, decrement, and reset buttons.</p>
                    
                    <p><strong>Requirements:</strong></p>
                    <ul>
                        <li>Display current count</li>
                        <li>Increment button (+1)</li>
                        <li>Decrement button (-1)</li>
                        <li>Reset button (back to 0)</li>
                        <li>Prevent count from going below 0</li>
                    </ul>

                    <details>
                        <summary>üí° Hint</summary>
                        <p>Use a single state variable and conditional logic:</p>
                        <pre><code class="language-typescript">const [count, setCount] = useState(0);

const decrement = () => {
    if (count > 0) {
        setCount(count - 1);
    }
    // Or: setCount(prev => Math.max(0, prev - 1));
};</code></pre>
                    </details>

                    <details>
                        <summary>‚úÖ Solution</summary>
                        <pre><code class="language-typescript">import React, { useState } from 'react';

const EnhancedCounter: React.FC = () => {
    const [count, setCount] = useState(0);

    const increment = () => {
        setCount(prevCount => prevCount + 1);
    };

    const decrement = () => {
        setCount(prevCount => Math.max(0, prevCount - 1));
    };

    const reset = () => {
        setCount(0);
    };

    return (
        &lt;div style={{ textAlign: 'center', padding: '2rem' }}&gt;
            &lt;h2&gt;Count: {count}&lt;/h2&gt;
            &lt;div style={{ display: 'flex', gap: '1rem', justifyContent: 'center' }}&gt;
                &lt;button 
                    onClick={decrement}
                    disabled={count === 0}
                    style={{ padding: '0.5rem 1rem' }}
                &gt;
                    -1
                &lt;/button&gt;
                &lt;button 
                    onClick={reset}
                    style={{ padding: '0.5rem 1rem' }}
                &gt;
                    Reset
                &lt;/button&gt;
                &lt;button 
                    onClick={increment}
                    style={{ padding: '0.5rem 1rem' }}
                &gt;
                    +1
                &lt;/button&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    );
};

export default EnhancedCounter;</code></pre>
                    </details>
                </div>

                <div class="card" style="background: #e3f2fd; border-left: 4px solid #2196F3;">
                    <h3>üèãÔ∏è Exercise 2: Text Input with Character Count</h3>
                    <p><strong>Goal:</strong> Create a text area that displays remaining characters.</p>
                    
                    <p><strong>Requirements:</strong></p>
                    <ul>
                        <li>Text area for input</li>
                        <li>Maximum 280 characters</li>
                        <li>Display remaining characters</li>
                        <li>Change color when close to limit (under 20)</li>
                        <li>Prevent input when at limit</li>
                    </ul>

                    <details>
                        <summary>üí° Hint</summary>
                        <p>Use state for the text and calculate remaining:</p>
                        <pre><code class="language-typescript">const [text, setText] = useState('');
const maxLength = 280;
const remaining = maxLength - text.length;
const isNearLimit = remaining < 20;</code></pre>
                    </details>

                    <details>
                        <summary>‚úÖ Solution</summary>
                        <pre><code class="language-typescript">import React, { useState } from 'react';

const CharacterCounter: React.FC = () => {
    const [text, setText] = useState('');
    const maxLength = 280;
    const remaining = maxLength - text.length;
    const isNearLimit = remaining < 20;
    const isAtLimit = remaining === 0;

    const handleChange = (e: React.ChangeEvent&lt;HTMLTextAreaElement&gt;) => {
        const newText = e.target.value;
        if (newText.length <= maxLength) {
            setText(newText);
        }
    };

    return (
        &lt;div style={{ maxWidth: '600px', margin: '0 auto', padding: '2rem' }}&gt;
            &lt;textarea
                value={text}
                onChange={handleChange}
                placeholder="What's on your mind?"
                style={{
                    width: '100%',
                    minHeight: '120px',
                    padding: '1rem',
                    fontSize: '1rem',
                    border: `2px solid ${isAtLimit ? '#f44336' : '#ddd'}`,
                    borderRadius: '8px',
                    resize: 'vertical'
                }}
            /&gt;
            
            &lt;div style={{
                marginTop: '0.5rem',
                textAlign: 'right',
                fontSize: '1rem',
                fontWeight: 'bold',
                color: isAtLimit ? '#f44336' : isNearLimit ? '#ff9800' : '#4CAF50'
            }}&gt;
                {remaining} characters remaining
            &lt;/div&gt;
            
            {isAtLimit && (
                &lt;p style={{ color: '#f44336', marginTop: '0.5rem' }}&gt;
                    Character limit reached!
                &lt;/p&gt;
            )}
        &lt;/div&gt;
    );
};

export default CharacterCounter;</code></pre>
                    </details>
                </div>

                <div class="card" style="background: #e3f2fd; border-left: 4px solid #2196F3;">
                    <h3>üèãÔ∏è Exercise 3: User Registration Form</h3>
                    <p><strong>Goal:</strong> Build a form that manages multiple related state values.</p>
                    
                    <p><strong>Requirements:</strong></p>
                    <ul>
                        <li>Fields: username, email, password, confirm password</li>
                        <li>Display all values as user types</li>
                        <li>Show validation messages</li>
                        <li>Check if passwords match</li>
                        <li>Show success message on "submit"</li>
                    </ul>

                    <details>
                        <summary>üí° Hint</summary>
                        <p>Use object state for form data:</p>
                        <pre><code class="language-typescript">interface FormData {
    username: string;
    email: string;
    password: string;
    confirmPassword: string;
}

const [formData, setFormData] = useState&lt;FormData&gt;({
    username: '',
    email: '',
    password: '',
    confirmPassword: ''
});</code></pre>
                    </details>

                    <details>
                        <summary>‚úÖ Solution</summary>
                        <pre><code class="language-typescript">import React, { useState } from 'react';

interface FormData {
    username: string;
    email: string;
    password: string;
    confirmPassword: string;
}

const RegistrationForm: React.FC = () => {
    const [formData, setFormData] = useState&lt;FormData&gt;({
        username: '',
        email: '',
        password: '',
        confirmPassword: ''
    });
    
    const [isSubmitted, setIsSubmitted] = useState(false);

    const handleChange = (field: keyof FormData, value: string) => {
        setFormData(prev => ({
            ...prev,
            [field]: value
        }));
    };

    const passwordsMatch = formData.password === formData.confirmPassword;
    const isFormValid = 
        formData.username.length >= 3 &&
        formData.email.includes('@') &&
        formData.password.length >= 6 &&
        passwordsMatch;

    const handleSubmit = (e: React.FormEvent) => {
        e.preventDefault();
        if (isFormValid) {
            setIsSubmitted(true);
            console.log('Form submitted:', formData);
        }
    };

    if (isSubmitted) {
        return (
            &lt;div style={{ maxWidth: '400px', margin: '0 auto', padding: '2rem', textAlign: 'center' }}&gt;
                &lt;h2 style={{ color: '#4CAF50' }}&gt;‚úÖ Registration Successful!&lt;/h2&gt;
                &lt;p&gt;Welcome, {formData.username}!&lt;/p&gt;
                &lt;button onClick={() => setIsSubmitted(false)}&gt;
                    Register Another User
                &lt;/button&gt;
            &lt;/div&gt;
        );
    }

    return (
        &lt;form onSubmit={handleSubmit} style={{ maxWidth: '400px', margin: '0 auto', padding: '2rem' }}&gt;
            &lt;h2&gt;User Registration&lt;/h2&gt;

            &lt;div style={{ marginBottom: '1rem' }}&gt;
                &lt;label style={{ display: 'block', marginBottom: '0.5rem' }}&gt;
                    Username:
                &lt;/label&gt;
                &lt;input
                    type="text"
                    value={formData.username}
                    onChange={(e) => handleChange('username', e.target.value)}
                    style={{ width: '100%', padding: '0.5rem' }}
                /&gt;
                {formData.username && formData.username.length < 3 && (
                    &lt;small style={{ color: '#f44336' }}&gt;
                        Username must be at least 3 characters
                    &lt;/small&gt;
                )}
            &lt;/div&gt;

            &lt;div style={{ marginBottom: '1rem' }}&gt;
                &lt;label style={{ display: 'block', marginBottom: '0.5rem' }}&gt;
                    Email:
                &lt;/label&gt;
                &lt;input
                    type="email"
                    value={formData.email}
                    onChange={(e) => handleChange('email', e.target.value)}
                    style={{ width: '100%', padding: '0.5rem' }}
                /&gt;
            &lt;/div&gt;

            &lt;div style={{ marginBottom: '1rem' }}&gt;
                &lt;label style={{ display: 'block', marginBottom: '0.5rem' }}&gt;
                    Password:
                &lt;/label&gt;
                &lt;input
                    type="password"
                    value={formData.password}
                    onChange={(e) => handleChange('password', e.target.value)}
                    style={{ width: '100%', padding: '0.5rem' }}
                /&gt;
                {formData.password && formData.password.length < 6 && (
                    &lt;small style={{ color: '#f44336' }}&gt;
                        Password must be at least 6 characters
                    &lt;/small&gt;
                )}
            &lt;/div&gt;

            &lt;div style={{ marginBottom: '1rem' }}&gt;
                &lt;label style={{ display: 'block', marginBottom: '0.5rem' }}&gt;
                    Confirm Password:
                &lt;/label&gt;
                &lt;input
                    type="password"
                    value={formData.confirmPassword}
                    onChange={(e) => handleChange('confirmPassword', e.target.value)}
                    style={{ width: '100%', padding: '0.5rem' }}
                /&gt;
                {formData.confirmPassword && !passwordsMatch && (
                    &lt;small style={{ color: '#f44336' }}&gt;
                        Passwords don't match
                    &lt;/small&gt;
                )}
            &lt;/div&gt;

            &lt;button 
                type="submit"
                disabled={!isFormValid}
                style={{
                    width: '100%',
                    padding: '0.75rem',
                    backgroundColor: isFormValid ? '#667eea' : '#ccc',
                    color: 'white',
                    border: 'none',
                    borderRadius: '4px',
                    cursor: isFormValid ? 'pointer' : 'not-allowed',
                    fontSize: '1rem',
                    fontWeight: 'bold'
                }}
            &gt;
                Register
            &lt;/button&gt;
        &lt;/form&gt;
    );
};

export default RegistrationForm;</code></pre>
                    </details>
                </div>

                <div class="card" style="background: #e3f2fd; border-left: 4px solid #2196F3;">
                    <h3>üèãÔ∏è Challenge Exercise: Shopping Cart</h3>
                    <p><strong>Goal:</strong> Build a mini shopping cart with add, remove, and quantity controls.</p>
                    
                    <p><strong>Requirements:</strong></p>
                    <ul>
                        <li>List of products with "Add to Cart" buttons</li>
                        <li>Cart that shows added items</li>
                        <li>Quantity controls (+/-) for each cart item</li>
                        <li>Remove item button</li>
                        <li>Display total price</li>
                        <li>Use array state for cart items</li>
                    </ul>

                    <details>
                        <summary>üí° Hint</summary>
                        <pre><code class="language-typescript">interface Product {
    id: number;
    name: string;
    price: number;
}

interface CartItem extends Product {
    quantity: number;
}

const [cart, setCart] = useState&lt;CartItem[]&gt;([]);</code></pre>
                    </details>

                    <details>
                        <summary>‚úÖ Solution</summary>
                        <p><em>Try this one on your own first! It combines everything you've learned about arrays, objects, and functional updates.</em></p>
                    </details>
                </div>
            </section>

            <!-- Section 10: Common Mistakes -->
            <section id="section10" class="lesson-section">
                <h2>üö´ Common Mistakes</h2>
                <p>Let's look at the most common useState mistakes and how to avoid them.</p>

                <div class="card" style="background-color: #fff3cd; border-left: 4px solid #ffc107;">
                    <h4>‚ùå Mistake 1: Mutating State Directly</h4>
                    <pre><code class="language-typescript">// ‚ùå WRONG
const [user, setUser] = useState({ name: 'Alice', age: 25 });
user.age = 26;  // Mutation!
setUser(user);  // Won't trigger re-render

// ‚úÖ CORRECT
setUser({ ...user, age: 26 });</code></pre>
                </div>

                <div class="card" style="background-color: #fff3cd; border-left: 4px solid #ffc107;">
                    <h4>‚ùå Mistake 2: Using State Value Immediately After Setting</h4>
                    <pre><code class="language-typescript">// ‚ùå WRONG
const [count, setCount] = useState(0);
setCount(5);
console.log(count);  // Still 0! Update is async

// ‚úÖ CORRECT - Use the value you're setting
setCount(5);
console.log(5);  // Or just trust it will be 5 on next render</code></pre>
                </div>

                <div class="card" style="background-color: #fff3cd; border-left: 4px solid #ffc107;">
                    <h4>‚ùå Mistake 3: Creating State Inside Conditionals</h4>
                    <pre><code class="language-typescript">// ‚ùå WRONG - Breaks Hook rules
if (someCondition) {
    const [count, setCount] = useState(0);  // Error!
}

// ‚úÖ CORRECT - Always at top level
const [count, setCount] = useState(0);
if (someCondition) {
    // Use count here
}</code></pre>
                </div>

                <div class="card" style="background-color: #fff3cd; border-left: 4px solid #ffc107;">
                    <h4>‚ùå Mistake 4: Not Using Functional Updates</h4>
                    <pre><code class="language-typescript">// ‚ùå WRONG - Multiple updates use stale value
setCount(count + 1);
setCount(count + 1);
setCount(count + 1);  // count only increases by 1!

// ‚úÖ CORRECT - Each update uses fresh value
setCount(prev => prev + 1);
setCount(prev => prev + 1);
setCount(prev => prev + 1);  // count increases by 3 ‚úÖ</code></pre>
                </div>

                <div class="card" style="background-color: #fff3cd; border-left: 4px solid #ffc107;">
                    <h4>‚ùå Mistake 5: Forgetting to Copy Nested Structures</h4>
                    <pre><code class="language-typescript">// ‚ùå WRONG - Shallow copy doesn't copy nested objects
const [user, setUser] = useState({
    name: 'Alice',
    address: { city: 'Boston' }
});
setUser({ ...user, address: { city: 'NYC' } });  // Loses other address fields!

// ‚úÖ CORRECT - Copy all levels
setUser({
    ...user,
    address: { ...user.address, city: 'NYC' }
});</code></pre>
                </div>

                <div class="card" style="background-color: #fff3cd; border-left: 4px solid #ffc107;">
                    <h4>‚ùå Mistake 6: Overusing State</h4>
                    <pre><code class="language-typescript">// ‚ùå WRONG - fullName doesn't need to be state
const [firstName, setFirstName] = useState('');
const [lastName, setLastName] = useState('');
const [fullName, setFullName] = useState('');  // Redundant!

// ‚úÖ CORRECT - Derive it instead
const [firstName, setFirstName] = useState('');
const [lastName, setLastName] = useState('');
const fullName = `${firstName} ${lastName}`;  // Just calculate it!</code></pre>
                </div>
            </section>

            <!-- Section 11: Best Practices -->
            <section id="section11" class="lesson-section">
                <h2>‚ú® Best Practices</h2>
                <p>Follow these guidelines to write clean, efficient, and maintainable useState code.</p>

                <div class="card" style="background: #e8f5e9; border-left: 4px solid #4CAF50;">
                    <h4>‚úÖ 1. Keep State Minimal</h4>
                    <p>Only store what you can't calculate from existing data:</p>
                    <pre><code class="language-typescript">// Good - Only store what's needed
const [todos, setTodos] = useState&lt;Todo[]&gt;([]);
const completedCount = todos.filter(t => t.completed).length;
const remainingCount = todos.length - completedCount;

// Bad - Storing derived values
const [todos, setTodos] = useState&lt;Todo[]&gt;([]);
const [completedCount, setCompletedCount] = useState(0);  // Can be calculated!
const [remainingCount, setRemainingCount] = useState(0);  // Can be calculated!</code></pre>
                </div>

                <div class="card" style="background: #e8f5e9; border-left: 4px solid #4CAF50;">
                    <h4>‚úÖ 2. Group Related State</h4>
                    <p>If values always change together, keep them in one object:</p>
                    <pre><code class="language-typescript">// Good - Related fields in one object
const [formData, setFormData] = useState({
    firstName: '',
    lastName: '',
    email: ''
});

// Less good - Separate states that change together
const [firstName, setFirstName] = useState('');
const [lastName, setLastName] = useState('');
const [email, setEmail] = useState('');</code></pre>
                </div>

                <div class="card" style="background: #e8f5e9; border-left: 4px solid #4CAF50;">
                    <h4>‚úÖ 3. Use Descriptive Names</h4>
                    <pre><code class="language-typescript">// Good - Clear what it represents
const [isModalOpen, setIsModalOpen] = useState(false);
const [userProfile, setUserProfile] = useState(null);
const [searchQuery, setSearchQuery] = useState('');

// Bad - Vague names
const [flag, setFlag] = useState(false);
const [data, setData] = useState(null);
const [text, setText] = useState('');</code></pre>
                </div>

                <div class="card" style="background: #e8f5e9; border-left: 4px solid #4CAF50;">
                    <h4>‚úÖ 4. Initialize with the Right Type</h4>
                    <pre><code class="language-typescript">// Good - Clear initial values
const [count, setCount] = useState(0);
const [user, setUser] = useState&lt;User | null&gt;(null);
const [items, setItems] = useState&lt;string[]&gt;([]);

// Bad - Unclear or wrong initial values
const [count, setCount] = useState();  // undefined
const [user, setUser] = useState({});  // Empty object (not typed!)
const [items, setItems] = useState();  // undefined</code></pre>
                </div>

                <div class="card" style="background: #e8f5e9; border-left: 4px solid #4CAF50;">
                    <h4>‚úÖ 5. Use Functional Updates When Appropriate</h4>
                    <pre><code class="language-typescript">// Good - Safe for all situations
const increment = () => {
    setCount(prevCount => prevCount + 1);
};

// Also good - When you're sure it's safe
const setToSpecificValue = () => {
    setCount(42);  // Not based on previous value
};</code></pre>
                </div>

                <div class="card" style="background: #e8f5e9; border-left: 4px solid #4CAF50;">
                    <h4>‚úÖ 6. Extract Complex Update Logic</h4>
                    <pre><code class="language-typescript">// Good - Readable and reusable
const addTodo = (text: string) => {
    const newTodo = {
        id: Date.now(),
        text,
        completed: false
    };
    setTodos(prev => [...prev, newTodo]);
};

const toggleTodo = (id: number) => {
    setTodos(prev => prev.map(todo =>
        todo.id === id ? { ...todo, completed: !todo.completed } : todo
    ));
};</code></pre>
                </div>

                <h3>useState Checklist</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Question</th>
                            <th>Check</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Can this value be calculated from existing state/props?</td>
                            <td>Don't store it</td>
                        </tr>
                        <tr>
                            <td>Do these values always change together?</td>
                            <td>Group them</td>
                        </tr>
                        <tr>
                            <td>Am I mutating state directly?</td>
                            <td>Create new objects/arrays</td>
                        </tr>
                        <tr>
                            <td>Does update depend on previous value?</td>
                            <td>Use functional update</td>
                        </tr>
                        <tr>
                            <td>Is my TypeScript type explicit enough?</td>
                            <td>Add generic if needed</td>
                        </tr>
                        <tr>
                            <td>Are Hooks at the top level?</td>
                            <td>Never in conditionals/loops</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- Section 12: Summary -->
            <section id="section12" class="lesson-section">
                <h2>üìö Summary</h2>
                <p>Congratulations! You've learned everything you need to know about the useState Hook. Let's recap the key concepts.</p>

                <div class="card">
                    <h3>What You Learned</h3>
                    
                    <p><strong>üé£ React Hooks Basics</strong></p>
                    <ul>
                        <li>Hooks let you use React features in functional components</li>
                        <li>Must be called at the top level (not in loops or conditionals)</li>
                        <li>Must be called from React functions</li>
                    </ul>

                    <p><strong>üß† State Fundamentals</strong></p>
                    <ul>
                        <li>State is data that changes over time</li>
                        <li>State persists between renders</li>
                        <li>Updating state triggers re-renders</li>
                        <li>State is different from props and regular variables</li>
                    </ul>

                    <p><strong>üéØ useState Hook</strong></p>
                    <ul>
                        <li>Syntax: <code>const [value, setValue] = useState(initial)</code></li>
                        <li>Returns current value and setter function</li>
                        <li>Use TypeScript generics for complex types</li>
                        <li>Updates are asynchronous (not immediate)</li>
                    </ul>

                    <p><strong>‚úèÔ∏è Updating State</strong></p>
                    <ul>
                        <li>Never mutate state directly</li>
                        <li>Always create new objects/arrays</li>
                        <li>Use spread operator for copying</li>
                        <li>Use functional updates when depending on previous value</li>
                    </ul>

                    <p><strong>üì¶ State with Objects and Arrays</strong></p>
                    <ul>
                        <li>Objects: <code>setState({ ...obj, key: value })</code></li>
                        <li>Arrays: Use <code>map()</code>, <code>filter()</code>, spread operator</li>
                        <li>Avoid mutating methods like <code>push()</code>, <code>sort()</code></li>
                        <li>Copy nested structures at every level</li>
                    </ul>
                </div>

                <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                    <h3 style="color: white;">üéØ Key Takeaways</h3>
                    <ul style="color: white;">
                        <li><strong>useState is your state management tool</strong> - It gives components memory</li>
                        <li><strong>Immutability is crucial</strong> - Never mutate, always create new values</li>
                        <li><strong>TypeScript makes it safer</strong> - Type your state for better DX</li>
                        <li><strong>Functional updates are safer</strong> - Use them when in doubt</li>
                        <li><strong>Keep state minimal</strong> - Don't store what you can calculate</li>
                    </ul>
                </div>

                <h3>üöÄ Next Steps</h3>
                <p>Now that you've mastered useState, you're ready to learn more advanced state concepts:</p>
                
                <div class="card" style="background: #e3f2fd; border-left: 4px solid #2196F3;">
                    <h4>üìñ Coming Up Next</h4>
                    <p><strong>Lesson 3.2: State Management Patterns</strong></p>
                    <ul>
                        <li>Lifting state up between components</li>
                        <li>Prop drilling and how to avoid it</li>
                        <li>State colocation strategies</li>
                        <li>Derived state patterns</li>
                    </ul>
                    <p>These patterns will help you organize state in larger applications!</p>
                </div>

                <h3>üí™ Practice Suggestions</h3>
                <p>To master useState, try building:</p>
                <ul>
                    <li><strong>Temperature Converter</strong> - Celsius to Fahrenheit with live updates</li>
                    <li><strong>Quiz App</strong> - Track current question, score, and user answers</li>
                    <li><strong>Expense Tracker</strong> - Add expenses, categorize them, show totals</li>
                    <li><strong>Color Picker</strong> - RGB sliders that update a preview box</li>
                    <li><strong>Multi-step Form</strong> - Navigate between steps while preserving data</li>
                </ul>

                <div class="card" style="background: #e8f5e9; border-left: 4px solid #4CAF50;">
                    <h4>‚ú® Remember</h4>
                    <p>useState is the foundation of React interactivity. The patterns you've learned here will be used in every React application you build. Take time to practice and experiment - the more you use it, the more natural it will become!</p>
                </div>

                <div class="card">
                    <h3>üìö Additional Resources</h3>
                    <ul>
                        <li><a href="https://react.dev/reference/react/useState" target="_blank" rel="noopener noreferrer">React Docs: useState</a></li>
                        <li><a href="https://react.dev/learn/state-a-components-memory" target="_blank" rel="noopener noreferrer">React Docs: State - A Component's Memory</a></li>
                        <li><a href="https://react.dev/learn/updating-objects-in-state" target="_blank" rel="noopener noreferrer">React Docs: Updating Objects in State</a></li>
                        <li><a href="https://react.dev/learn/updating-arrays-in-state" target="_blank" rel="noopener noreferrer">React Docs: Updating Arrays in State</a></li>
                    </ul>
                </div>

                <div class="card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white;">
                    <h3 style="color: white;">üéâ Congratulations!</h3>
                    <p style="color: white;">You've completed Lesson 3.1 and learned how to make your React components interactive and stateful! You now understand one of the most important concepts in React. Well done! üöÄ</p>
                </div>
            </section>

        </div>
    </main>

    <!-- Lesson Navigation -->
    <div class="lesson-nav">
        <a href="module_project_2_portfolio_a.html" class="lesson-nav-btn lesson-nav-prev">
            <span>‚Üê Previous</span>
            <small>Module 2 Project</small>
        </a>
        <a href="index.html" class="lesson-nav-btn lesson-nav-home">
            <span>‚åÇ</span>
            <small>Home</small>
        </a>
           <a href="lesson_3_2_state_management_patterns.html" class="lesson-nav-btn lesson-nav-next">
            <span>Next ‚Üí</span>
            <small>Lesson 3.2: State Management Patterns</small>
        </a>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <p>&copy; 2024 React TypeScript Course. All rights reserved.</p>
            <p>
                <a href="index.html">Home</a> |
                <a href="index.html#modules">Modules</a> |
                <a href="https://github.com/practicalace" target="_blank" rel="noopener noreferrer">GitHub</a>
            </p>
        </div>
    </footer>

    <script src="js/clipboard.js"></script>
    <script src="js/course-enhancements.js"></script>
</body>
</html>
